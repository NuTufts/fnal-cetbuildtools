#!/bin/bash


result=${1}
qual=${2}
flvr=${3}

OS1=`uname`
plat=`uname -p`
# platform is driven by ups flavor at setup
if [ -n "${flvr}" ]
then
    flvr0=`echo ${flvr} | cut -f1 -d"+"`
    if [ "${flvr0}" = "Linux64bit" ]
    then
        plat="x86_64"
    fi
    if [ "${flvr0}" = "Linuxppc" ]
    then
        plat="ppc"
    fi
fi

if [ ${OS1} = "Darwin" ]
then
   OSnum=`uname -r | cut -f1 -d"."`
   OS=${OS1}${OSnum}
   subdir=d${OSnum}.${plat}.${qual}
elif [ "${flvr0}" = "Linuxppc" ]
then
   OS=slf5
   subdir=${OS}.${plat}.${qual}
elif [ `lsb_release -d | cut -f2 | cut  -f1 -d" "` = "Ubuntu" ]
then
   OS1=ub
   OSnum=`lsb_release -r | cut -f2 | cut -f1 -d"."`
   OS=${OS1}${OSnum}
   plat=`uname -m`
   subdir=${OS1}${OSnum}.${plat}.${qual}
else
   OSnum=`lsb_release -r | cut -f2 | cut -f1 -d"."`
   OS=${OS1}${OSnum}
   subdir=${OS1}${OSnum}.${plat}.${qual}
   if [ `lsb_release -d | cut  -f3 -d" "` = "SLF" ]
   then
      OS=slf${OSnum}
      subdir=slf${OSnum}.${plat}.${qual}
   fi
   if [ `lsb_release -d | cut  -f4 -d" "` = "SLC" ]
   then
      OS=slc${OSnum}
      subdir=slc${OSnum}.${plat}.${qual}
   fi
   if [ `lsb_release -d | cut  -f4 -d" "` = "LTS" ]
   then
      OS=slf${OSnum}
      subdir=slf${OSnum}.${plat}.${qual}
   fi
fi

if [ "${result}" = "os" ]
then
    echo ${OS}
fi
if [ "${result}" = "platform" ]
then
    echo ${plat}
fi
if [ "${result}" = "subdir" ]
then
    echo ${subdir}
fi

exit 0
